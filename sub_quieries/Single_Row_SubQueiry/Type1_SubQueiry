-- ===========================================================
-- SQL Subqueries - Type 1 (Single-Row Subqueries)
-- Author: Tirupathi Rao
-- Description: Practice queries on single-row subqueries using job_postings_fact dataset
-- ===========================================================

-- ðŸ§© Query 1 â€” Above Average Salary
SELECT job_id, job_title, company_name, salary_year_avg
FROM job_postings_fact
WHERE salary_year_avg >
      (SELECT AVG(salary_year_avg)
       FROM job_postings_fact)
ORDER BY salary_year_avg DESC;

-- ðŸ§© Query 2 â€” Highest Salary Job(s)
SELECT job_id, job_title, company_name, salary_year_avg
FROM job_postings_fact
WHERE salary_year_avg =
      (SELECT MAX(salary_year_avg)
       FROM job_postings_fact);

-- ðŸ§© Query 3 â€” Lowest Salary Job(s)
SELECT job_id, job_title, company_name, salary_year_avg
FROM job_postings_fact
WHERE salary_year_avg =
      (SELECT MIN(salary_year_avg)
       FROM job_postings_fact);

-- ðŸ§© Query 4 â€” Above Googleâ€™s Average Salary
SELECT job_id, job_title, company_name, salary_year_avg
FROM job_postings_fact
WHERE salary_year_avg >
      (SELECT AVG(salary_year_avg)
       FROM job_postings_fact
       WHERE company_name = 'Google');

-- ðŸ§© Query 5 â€” Jobs Above Python Developer Salary
SELECT job_id, job_title, company_name, salary_year_avg
FROM job_postings_fact
WHERE salary_year_avg >
      (SELECT salary_year_avg
       FROM job_postings_fact
       WHERE job_title = 'Python Developer'
       LIMIT 1);

-- ðŸ§© Query 6 â€” Jobs Posted After Latest â€œData Analystâ€ Job
SELECT job_id, job_title, job_posted_date
FROM job_postings_fact
WHERE job_posted_date >
      (SELECT MAX(job_posted_date)
       FROM job_postings_fact
       WHERE job_title = 'Data Analyst');

-- âœ… Alternative for MySQL/PostgreSQL
SELECT * 
FROM job_postings_fact
WHERE job_posted_date > (
    SELECT job_posted_date
    FROM job_postings_fact
    WHERE job_title = 'Data Analyst'
    ORDER BY job_posted_date DESC
    LIMIT 1
);

-- ðŸ§© Query 7 â€” Jobs Between Min and Max Salary Range
SELECT job_id, job_title, salary_year_avg
FROM job_postings_fact
WHERE salary_year_avg BETWEEN
      (SELECT MIN(salary_year_avg) FROM job_postings_fact)
  AND (SELECT MAX(salary_year_avg) FROM job_postings_fact);

-- ===========================================================
-- END OF FILE
-- ===========================================================
